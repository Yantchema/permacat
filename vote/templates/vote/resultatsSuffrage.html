{% extends 'base.html' %}

{% block subtitle %}
<div class="row">
    <div class="col-md-2">
        <a href="{{ suffrage.get_absolute_url }}" class="btn btn-primary" ><i class="fa fa-arrow-left"></i> retour</a>
    </div>
    <div class="col-md-8 textepetit">
        {{suffrage | safe}}
    </div>
    <div class="col-md-2 textepetit">
        Du {{ suffrage.start_time|date:"d/m/Y"  }} au {{ suffrage.end_time|date:"d/m/Y"  }}
    </div>
</div>

<h3>Résultats du vote</h3>
{% endblock %}
{% block content %}
{%if res_bin %}
<div class="row justify-content-center">
<div class="col-sm-12 col-md-10 col-lg-8 textcenter ">
  <h4>Questions binaires</h4>
<div style="overflow-x:auto;">
    {% for qb, res in res_bin.items %}
    <h5>{{qb}}  {{res.resultat}}</h5>
<table class="comicGreen" cellpadding="2">
<thead>
  <tr>
    <th class="tg-0lax">Votants </th>
    <th class="tg-baqh">{{res.nbTotal}}</th>
    <th class="tg-baqh">

    </th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">Oui</td>
    <td class="tg-baqh">{{res.nbOui.0}}</td>
    <td class="tg-baqh">{{res.nbOui.1}}</td>
  </tr>
  <tr>
    <td class="tg-0lax">Non</td>
    <td class="tg-baqh">{{res.nbNon.0}}</td>
    <td class="tg-baqh">{{res.nbNon.1}}</td>
  </tr>
  <tr>
    <td class="tg-0lax">Ne se prononce pas</td>
    <td class="tg-baqh">{{res.nbNSPP.0}}</td>
    <td class="tg-baqh">{{res.nbNSPP.1}}</td>
  </tr>
</tbody>
</table>
<hr>
{% endfor %}
</div></div></div>
{% endif %}

{%if res_majo %}
<div class="row justify-content-center">
<div class="col-sm-12 textcenter ">
    <h4>Questions soumises au jugement majoritaire</h4>

        {% for qb, res in res_majo.items %}
        <h5>{{qb}}</h5>
        <p>Propositions :</p>
        <ol>
            {% for re in res%}
            <li>{{re.0}}</li>
            {% endfor %}
        </ol>
        <table class="comicGreen" cellpadding="2px;">
        <thead>
          <tr>
                <th class="tg-0lax">Proposition  </th>
                {% for choix in choixMajo %}
                    {% if forloop.counter0 > 0 %}
                    <th class="tg-baqh">{{choix.1}}</th>
                    {%endif%}
                {%endfor%}
                <th class="tg-baqh">Jauge majoritaire</th>
          </tr>
        </thead>
        <tbody>
        {% for re in res%}
          <tr>
            <td class="tg-0lax">{{forloop.counter}}</td>
            {% for nom, pourcent in re.2 %}
                 <td class="tg-baqh">{{pourcent}}%</td>
            {%endfor%}

            <td class="tg-baqh">{{re.1}}</td>
          </tr>
        {%endfor%}

        </tbody>
        </table>
        {% endfor %}
</div>
</div>
<hr>

{% endif %}

<div class="row justify-content-center">
<div class="col-sm-12 col-md-10 col-lg-8 textcenter ">
{% if vote %}
        <p> Vous avez voté :</p>
        {% with reponses=vote.getVoteStr   %}
        <p>Questions binaires : </p>
        <ol>
            {% for rep in reponses.0 %}
            <li> {{rep}} </li>
            {% endfor %}
        </ol>
        <p>Questions soumises au jugement majoritaire : </p>
        <ul>
            {% for rep in reponses.1 %}
            {% ifchanged rep.0 %}
            </ul>
            <p> Question : {{rep.0}} </p>
            <ul>
            {% endifchanged%}

            <li> {{rep.1}} </li>
            {% endfor %}
        </ul>
        {% endwith %}
        {% if vote.commentaire %}
        <tr><td style="width: 30%;">Commentaire :</td><td style="width: 70%;">{{vote.commentaire|safe}}</td></tr>
        {% endif %}
    {% else %}
        <hr>
        <p> Vous n'avez pas participé à ce suffrage</p>
    {% endif %}
</div>
</div>

{% endblock %}


