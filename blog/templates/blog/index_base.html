{% extends 'base_forum.html' %}
{% load static %}
{% load blog_filters %}
{% load fontawesome %}

{% load activity_tags %}
{%block header %}
<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
<script src="{% static 'js/infinite.min.js' %}"></script>
{%endblock%}
{% block title %} - Forum {% endblock  %}
{%block subtitle%}

<div class="row">
    <div class="col-md-12 textcenter">
        <div class="row justify-content-center">
            <div class="col-md-4 offset-md-4">
                <h3>Forum</h3>
            </div>
            <div class="col-md-4 ">
                <button type="button" class="btn btn-light btn-sm" data-toggle="modal" data-target="#help">
                 {% fontawesome_icon 'question-circle' %}
                </button>
                <!-- Modal -->
                <div class="modal fade" id="help" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog textaide" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                          <div class="row justify-content-center">
                           <h5 > Qu'est ce que le forum permacat ?</h5>
                          </div>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body textleft">
                          <p>Le forum est un blog collaboratif. C'est un lieu virtuel d'échange d'idées, d'annonce d'un evenement, de partage de connaissainces, d'expression personnelle et de discussion. </p>
                          <p>Chacun est libre d'ajouter un article au forum ou de réagir en commentaire d'un article posté. </p>
                          <p>Vous pouvez choisir de voir la liste des articles de chaque catégorie (agenda, ecovillage, documentation, etc) en cliquant sur "choisir une catégorie"</p>
                          <p>Pour vous tenir au courant des nouveaux articles postés dans le forum, vous pouvez vous "abonner" en ciquant sur la cloche. Vous recevrez alors des informations par mail sur les nuoveaux articles.</p>
                      </div>
                    </div>
                  </div>
                </div>
                <a href="{% url 'blog:suivre_articles' %}">
                    {% if request.user|is_following:suivis %}
                    <button type="button" class="btn btn-light btn-sm" data-toggle="tooltip" data-placement="bottom" title="Vous êtes abonné : Cliquez pour arreter de recevoir un mail à chaque nouvel article">
                         {% fontawesome_icon 'bell' %}
                    </button>
                    {% else %}
                    <button type="button" class="btn btn-secondary btn-sm" data-toggle="tooltip" data-placement="bottom" title="Vous n'êtes pas abonné : Cliquez pour recevoir un mail à chaque nouvel article">
                         {% fontawesome_icon 'bell-slash' %}
                    </button>
                    {% endif %}
                </a>

                    <a href="{% url 'blog:suiveursArticles' %}">
                        <button type="button" class="btn btn-secondary btn-sm" data-toggle="tooltip" data-placement="bottom" title="Voir abonnés">
                             {% fontawesome_icon 'eye' %}
                        </button>
                    </a>
        </div>
    </div>
    <div class="row justify-content-center">
            <a href="{% url 'blog:ajouterNouvelArticle' %}">
            <button type="button" class="btn  btn-success" >
                    <i class="fa fa-plus"></i>&nbsp; Ajouter un article
                </button>
            </a>&ensp;
    </div>
    <hr>
</div>
</div>
	<div class="row">
		<div class="col-md-12">
			<nav class="navbar navbar-expand-sm navbar-light bg-light">
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="navbar-nav">
                        <li class="nav-item dropdown">
                            <a class="nav-item" href="#" id="navbarDropdownAsso" data-toggle="dropdown">
                                 <button type="button" class="btn  btn-success dropdown-toggle" >
                                {% if asso_courante  %}
      {{asso_courante}}
        {%else%}
        Collectif...
      {%endif%}
                             </button>
                                </a>
							<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                <a class=" dropdown-item " style="background:white;" href="{%url 'blog:index' %}">Tous les articles</a>
                                <div class="dropdown-divider"></div>
            {% for asso_nom, asso_abreviation in asso_list %}
            <a class=" dropdown-item " style="background:{{cat_coul}};" href="{%url 'blog:index_asso' asso=asso_abreviation %}"><span>{{asso_nom}}</span></a>
            {% endfor %}
							</div>
						</li>

<li class="nav-item dropdown">
                            <a class="nav-item " href="#" id="navbarDropdownCategorie" data-toggle="dropdown">
                                 <button type="button" class="btn  btn-primary dropdown-toggle" >
                                {% if request.GET.categorie  %}
      Catégorie : {{categorie_courante}}
      {%elif request.GET.permacat %}
      Articles Permacat
      {%elif request.GET.auteur %}
      Articles de {{request.GET.auteur}}
      {%elif typeFiltre == 'archives' %}
      Archives
        {%else%}
        Choisir une catégorie...
      {%endif%}
                                 </button>
                                </a>
							<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                <a class=" dropdown-item " style="background:white;" href="{%url 'blog:index' %}">Toutes les catégories</a>
                                <div class="dropdown-divider"></div>
            {% for categorie_id, cat_nom, cat_coul in categorie_list %}
            <a class=" dropdown-item " style="background:{{cat_coul}};" href="?categorie={{categorie_id}}"><span>{{cat_nom}}</span></a>
            {% endfor %}
    <div class="dropdown-divider"></div>
                                                                <a class=" dropdown-item " style="background:grey;" href="?archives=True"><span>Archives</span></a>

							</div>
						</li>


                <li class="nav-item dropdown">
                      <a class="nav-item btn-block" href="#" id="menuOrdreTri" data-toggle="dropdown">

                <button class="btn btn-light dropdown-toggle">
                   Trier par...
           </button>
                      </a>
                <div class="dropdown-menu"  aria-labelledby="menuOrdreTri"  id="idOrdreTri">
                    {% for titre, ordre in ordreTriPossibles.items %}
                     <a class="dropdown-item"  href="?{{ request.GET.urlencode|sansOrdreTri}}&ordreTri={{ordre}}">{{titre}}</a>
                    {% endfor %}
                </div>
            </li>
					</ul>


</div>
			</nav>
		</div>
	</div>
</div>


{%endblock%}
{% block content %}

<div class="infinite-container">
    {% for article in article_list %}
    <div class="infinite-item">
            {% include "blog/article_template.html" with article=article %}
    <hr>
    </div>

    {% endfor %}
</div>
{%include 'pagination.html' %}

{% endblock %}
